---
title: "桥接模式 (Bridge)"
date: 2021-12-08T16:29:53+08:00
draft: false
tags: [设计模式]
categories: [笔记] 
---

# 定义

桥接模式分离抽象部分和实现部分，使得两部分独立扩展。

策略模式使抽象部分和实现部分分离，可以独立变化。

**桥接模式**类似于策略模式，区别在于**策略模式**封装一系列算法使得算法可以互相替换。

**何时使用**

实现系统可能有多个角度分类，每一种角度都可能变化。

# 样例

```go
package bridge

import "fmt"

// AbstractMessage 消息抽象接口
type AbstractMessage interface {
	SendMessage(text, to string)
}

// MessageImplementer 消息实现接口
type MessageImplementer interface {
	Send(text, to string)
}

// MessageSMS 消息通过短信发送
type MessageSMS struct{}

// Send 为MessageSMS实现Send方法
func (*MessageSMS) Send(text, to string) {
	fmt.Printf("send %s to %s via SMS", text, to)
}

func ViaSMS() MessageImplementer {
	return &MessageSMS{}
}

// MessageEmail 消息通过邮件发送
type MessageEmail struct{}

// Send 为MessageEmail实现Send方法
func (*MessageEmail) Send(text, to string) {
	fmt.Printf("send %s to %s via Email", text, to)
}

func ViaEmail() MessageImplementer {
	return &MessageEmail{}
}

type CommonMessage struct {
	method MessageImplementer
}

// SendMessage 将抽象部分与实体部分分离开
func (m *CommonMessage) SendMessage(text, to string) {
	m.method.Send(text, to)
}

func NewCommonMessage(method MessageImplementer) *CommonMessage {
	return &CommonMessage{
		method: method,
	}
}

type UrgencyMessage struct {
	method MessageImplementer
}

func (m *UrgencyMessage) SendMessage(text, to string) {
	m.method.Send(fmt.Sprintf("[Urgency] %s", text), to)
}

func NewUrgencyMessage(method MessageImplementer) *UrgencyMessage {
	return &UrgencyMessage{
		method: method,
	}
}

```

测试

```go
package bridge

func ExampleCommonSMS() {
	m := NewCommonMessage(ViaSMS())
	m.SendMessage("have a drink?", "bob")
	// Output:
	// send have a drink? to bob via SMS
}

func ExampleCommonEmail() {
	m := NewCommonMessage(ViaEmail())
	m.SendMessage("have a drink?", "bob")
	// Output:
	// send have a drink? to bob via Email
}

func ExampleUrgencySMS() {
	m := NewUrgencyMessage(ViaSMS())
	m.SendMessage("have a drink?", "bob")
	// Output:
	// send [Urgency] have a drink? to bob via SMS
}

func ExampleUrgencyEmail() {
	m := NewUrgencyMessage(ViaEmail())
	m.SendMessage("have a drink?", "bob")
	// Output:
	// send [Urgency] have a drink? to bob via Email
}
```

# 参考文献

1. https://github.com/kamranahmedse/design-patterns-for-humans
2. https://github.com/senghoo/golang-design-pattern

