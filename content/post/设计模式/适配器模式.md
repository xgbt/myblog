---
title: "适配器模式 (Adapter)"
date: 2021-12-07T16:29:53+08:00
draft: false
tags: [设计模式]
categories: [笔记] 
---

# 定义

适配器模式用于转换一种接口适配另一种接口。

**何时使用**

- 系统需要使用现有的类，而此类的接口不符合系统的需要。 

- 想要建立一个可以重复使用的类，用于与一些彼此之间没有太大关联的一些类，包括一些可能在将来引进的类一起工作，这些源类不一定有一致的接口。

- 通过接口转换，将一个类插入另一个类系中。

**Golang**

实际使用中Adaptee一般为接口，并且使用工厂函数生成实例。

在Adapter中匿名组合Adaptee接口，所以Adapter类也拥有SpecificRequest实例方法，又因为Go语言中非入侵式接口特征，其实Adapter也适配Adaptee接口。

# 样例

有适配器Adapter，要适配Target接口，Adpatee是被适配接口，

那么Adapter将实现Target接口，但实际上用的都是Adpatee的方法。

```go
package adapter

//Target 是适配的目标接口
type Target interface {
	Request() string
}

//Adaptee 是被适配的目标接口
type Adaptee interface {
	SpecificRequest() string
}

//AdapteeImpl 是被适配的目标类
type adapteeImpl struct{}

//SpecificRequest 是目标类的一个方法
func (*adapteeImpl) SpecificRequest() string {
	return "adaptee method"
}

//NewAdaptee 是被适配接口的工厂函数
func NewAdaptee() Adaptee {
	return &adapteeImpl{}
}

//Adapter 将Adaptee接口转换为Target接口的适配器
type adapter struct {
	Adaptee
}

//Request 实现Target接口
func (a *adapter) Request() string {
	return a.SpecificRequest()
}

//NewAdapter 是Adapter的工厂函数
func NewAdapter(adaptee Adaptee) Target {
	return &adapter{
		Adaptee: adaptee,
	}
}
```

测试

```go
package adapter

import "testing"

var expect = "adaptee method"

func TestAdapter(t *testing.T) {
   adaptee := NewAdaptee()
   target := NewAdapter(adaptee)
   res := target.Request()
   if res != expect {
      t.Fatalf("expect: %s, actual: %s", expect, res)
   }
}
```

# 参考文献

1. https://github.com/kamranahmedse/design-patterns-for-humans
2. https://github.com/senghoo/golang-design-pattern

